---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# Kernel Ridge Regression (KRR) Example

A simple example using `krr_fit()` and `predict()`  
to visualize the fitted Kernel Ridge Regression curve.

---

## Example

```r
set.seed(1)

# 1. 데이터 생성
n = 150
X = matrix(runif(n, -1, 1), ncol = 1)
ftrue = function(x) sin(2*pi*x) + 0.5*cos(4*pi*x)
y = ftrue(X[, 1]) + rnorm(n, sd = 0.1)

# 2. 모델 적합
fit = krr_fit(X, y, rho = 3, lambda = 1e-4)

# 3. 새로운 grid 생성 후 예측
grid_x = seq(-1, 1, length.out = 200)
X_new = matrix(grid_x, ncol = 1)
y_pred = predict(fit, X_new)

# 4. ggplot2로 시각화
library(ggplot2)

data_true = data.frame(x = grid_x, y = ftrue(grid_x))
data_pred = data.frame(x = grid_x, y = y_pred)
data_train = data.frame(x = X[, 1], y = y)

ggplot() +
  geom_point(data = data_train, aes(x = x, y = y), color = "gray", alpha = 0.7) +
  geom_line(data = data_true, aes(x = x, y = y),
             color = "red", linetype = "dashed", size = 1) +
  geom_line(data = data_pred, aes(x = x, y = y),
             color = "#0072B2", size = 1.2) +
  labs(
    title = "Kernel Ridge Regression Fit",
    x = "x", y = "y",
    caption = "Orange dashed = True function | Blue line = KRR fit"
  ) +
  theme_minimal(base_size = 13) +
  theme(plot.title = element_text(hjust = 0.5))
